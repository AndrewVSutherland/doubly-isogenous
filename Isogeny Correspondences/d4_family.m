/* D4 family from ICERM project
*/

C<zeta> := CyclotomicField(4); //coefficients
K<u> := FunctionField(C);
S<s,t> := PolynomialRing(C,2);

lambda_list := [
    u^2,
    4 * u^2/(u^2 + 1)^2,
    4 * zeta * u/(u + zeta)^2,
    2 * (u^2 - 1)/(u + zeta)^2,
    -2 * zeta * u/(u - zeta)^2,
    2 * zeta * u/(u + zeta)^2
]; //this leaves out the constant orbit, which is OK

R<x> := PolynomialRing(K);
j_list := [jInvariant(EllipticCurve(x * (x-1) * (x-lmbda))) : lmbda in lambda_list];

/*
data_array := search_isogenies(s,t,j_list);
known_correspondences := [ <rel,data_array[rel]> : rel in Keys(data_array)];
*/

known_correspondences:=
[
    <s^2*t + s*t^2 - s - t, { <<1, 3, 3>, <1, 5, 6>>, <<1, 1, 1>, <1, 5, 6>>, 
    <<1, 3, 3>, <1, 6, 5>>, <<1, 1, 1>, <1, 6, 5>>, <<1, 4, 4>, <1, 5, 6>>, <<1,
    4, 4>, <1, 6, 5>> }>,
    <s^4*t^3 - s^4*t - s^3*t^4 + 6*s^3*t^2 - s^3 - 6*s^2*t^3 + 6*s^2*t + s*t^4 -
        6*s*t^2 + s + t^3 - t, { <<1, 5, 5>, <1, 6, 6>>, <<1, 2, 2>, <1, 5, 5>>,
    <<1, 2, 2>, <1, 6, 6>> }>,
    <s^4*t^4 + 2*s^4*t^2 + s^4 + 4*zeta*s^3*t^4 - 24*zeta*s^3*t^2 + 4*zeta*s^3 -
        6*s^2*t^4 - 12*s^2*t^2 - 6*s^2 - 4*zeta*s*t^4 + 24*zeta*s*t^2 - 4*zeta*s
        + t^4 + 2*t^2 + 1, { <<1, 5, 4>, <2, 2, 2>>, <<1, 6, 3>, <2, 2, 2>>, 
    <<1, 5, 4>, <1, 6, 3>> }>,
    <s^4*t^4 + 4*zeta*s^4*t^3 - 6*s^4*t^2 - 4*zeta*s^4*t + s^4 + 4*zeta*s^3*t^4 
        + 48*s^3*t^3 - 24*zeta*s^3*t^2 - 48*s^3*t + 4*zeta*s^3 - 6*s^2*t^4 - 
        24*zeta*s^2*t^3 + 36*s^2*t^2 + 24*zeta*s^2*t - 6*s^2 - 4*zeta*s*t^4 - 
        48*s*t^3 + 24*zeta*s*t^2 + 48*s*t - 4*zeta*s + t^4 + 4*zeta*t^3 - 6*t^2 
        - 4*zeta*t + 1, { <<2, 6, 6>, <4, 2, 2>> }>,
    <s^4*t^4 - 2*s^4*t^2 + s^4 - 4*zeta*s^3*t^4 - 24*zeta*s^3*t^2 - 4*zeta*s^3 -
        6*s^2*t^4 + 12*s^2*t^2 - 6*s^2 + 4*zeta*s*t^4 + 24*zeta*s*t^2 + 4*zeta*s
        + t^4 - 2*t^2 + 1, { <<2, 5, 1>, <2, 6, 4>>, <<2, 2, 2>, <2, 6, 4>>, 
    <<2, 2, 2>, <2, 5, 1>> }>,
    <s^2*t - s*t^2 + s - t, { <<1, 1, 1>, <1, 5, 5>>, <<1, 4, 4>, <1, 5, 5>>, 
    <<1, 1, 1>, <1, 6, 6>>, <<1, 3, 3>, <1, 5, 5>>, <<1, 3, 3>, <1, 6, 6>>, <<1,
    4, 4>, <1, 6, 6>> }>,
    <s^4*t^2 - s^2*t^4 - s^2 + t^2, { <<1, 1, 1>, <1, 3, 3>>, <<1, 2, 2>, <1, 4,
    4>>, <<1, 1, 1>, <1, 2, 2>>, <<1, 1, 1>, <1, 4, 4>>, <<1, 2, 2>, <1, 3, 3>>,
    <<1, 3, 3>, <1, 4, 4>> }>,
    <s^4*t^2 - 2*zeta*s^3*t^4 - 2*zeta*s^3 - 6*s^2*t^2 + 2*zeta*s*t^4 + 2*zeta*s
        + t^2, { <<2, 2, 2>, <2, 6, 3>>, <<1, 5, 1>, <2, 6, 3>>, <<1, 5, 1>, <2,
    2, 2>> }>,
    <s^4*t^4 - 4*zeta*s^4*t^3 - 6*s^4*t^2 + 4*zeta*s^4*t + s^4 - 2*s^2*t^4 - 
        24*zeta*s^2*t^3 + 12*s^2*t^2 + 24*zeta*s^2*t - 2*s^2 + t^4 - 4*zeta*t^3 
        - 6*t^2 + 4*zeta*t + 1, { <<2, 2, 2>, <2, 4, 6>>, <<2, 1, 5>, <2, 4, 
    6>>, <<2, 1, 5>, <2, 2, 2>> }>,
    <s^4*t^3 - s^4*t + s^3*t^4 - 6*s^3*t^2 + s^3 - 6*s^2*t^3 + 6*s^2*t - s*t^4 +
        6*s*t^2 - s + t^3 - t, { <<1, 5, 6>, <1, 6, 5>>, <<1, 2, 2>, <1, 6, 5>>,
    <<1, 2, 2>, <1, 5, 6>> }>,
    <s^4*t^4 + 4*zeta*s^4*t^3 - 6*s^4*t^2 - 4*zeta*s^4*t + s^4 - 4*zeta*s^3*t^4 
        - 48*s^3*t^3 + 24*zeta*s^3*t^2 + 48*s^3*t - 4*zeta*s^3 - 6*s^2*t^4 - 
        24*zeta*s^2*t^3 + 36*s^2*t^2 + 24*zeta*s^2*t - 6*s^2 + 4*zeta*s*t^4 + 
        48*s*t^3 - 24*zeta*s*t^2 - 48*s*t + 4*zeta*s + t^4 + 4*zeta*t^3 - 6*t^2 
        - 4*zeta*t + 1, { <<2, 5, 6>, <4, 2, 2>> }>,
    <s^4*t^4 + 4*zeta*s^4*t^3 - 6*s^4*t^2 - 4*zeta*s^4*t + s^4 - 2*s^2*t^4 + 
        24*zeta*s^2*t^3 + 12*s^2*t^2 - 24*zeta*s^2*t - 2*s^2 + t^4 + 4*zeta*t^3 
        - 6*t^2 - 4*zeta*t + 1, { <<2, 1, 6>, <2, 2, 2>>, <<2, 1, 6>, <2, 4, 
    5>>, <<2, 2, 2>, <2, 4, 5>> }>,
    <s^4*t^3 - s^4*t - 1/2*zeta*s^2*t^4 + 3*zeta*s^2*t^2 - 1/2*zeta*s^2 + t^3 - 
        t, { <<2, 2, 2>, <2, 3, 5>>, <<1, 1, 6>, <2, 2, 2>>, <<1, 1, 6>, <2, 3, 
    5>> }>,
    <s^4*t^4 - 4*zeta*s^4*t^3 - 6*s^4*t^2 + 4*zeta*s^4*t + s^4 - 4*zeta*s^3*t^4 
        + 48*s^3*t^3 + 24*zeta*s^3*t^2 - 48*s^3*t - 4*zeta*s^3 - 6*s^2*t^4 + 
        24*zeta*s^2*t^3 + 36*s^2*t^2 - 24*zeta*s^2*t - 6*s^2 + 4*zeta*s*t^4 - 
        48*s*t^3 - 24*zeta*s*t^2 + 48*s*t + 4*zeta*s + t^4 - 4*zeta*t^3 - 6*t^2 
        + 4*zeta*t + 1, { <<2, 5, 5>, <4, 2, 2>> }>,
    <s^2*t^2 - 2*zeta*s^2*t - s^2 + 2*zeta*s*t^2 - 4*s*t - 2*zeta*s - t^2 + 
        2*zeta*t + 1, { <<1, 4, 6>, <1, 5, 4>>, <<1, 3, 5>, <1, 6, 3>>, <<1, 4, 
    6>, <1, 6, 3>>, <<1, 3, 5>, <1, 5, 4>> }>,
    <s^2*t^2 + 2*zeta*s^2*t - s^2 - 2*zeta*s*t^2 - 4*s*t + 2*zeta*s - t^2 - 
        2*zeta*t + 1, { <<1, 3, 6>, <1, 5, 3>>, <<1, 4, 5>, <1, 6, 4>>, <<1, 3, 
    6>, <1, 6, 4>>, <<1, 4, 5>, <1, 5, 3>> }>,
    <s^2*t^2 + 2*zeta*s^2*t - s^2 + 2*zeta*s*t^2 + 4*s*t - 2*zeta*s - t^2 - 
        2*zeta*t + 1, { <<1, 3, 6>, <1, 6, 3>>, <<1, 3, 6>, <1, 5, 4>>, <<1, 4, 
    5>, <1, 6, 3>>, <<1, 4, 5>, <1, 5, 4>> }>,
    <s^4*t^4 - 4*zeta*s^4*t^3 - 6*s^4*t^2 + 4*zeta*s^4*t + s^4 + 2*s^2*t^4 + 
        24*zeta*s^2*t^3 - 12*s^2*t^2 - 24*zeta*s^2*t + 2*s^2 + t^4 - 4*zeta*t^3 
        - 6*t^2 + 4*zeta*t + 1, { <<1, 4, 6>, <2, 2, 2>>, <<1, 3, 5>, <2, 2, 
    2>>, <<1, 3, 5>, <1, 4, 6>> }>,
    <s^4*t^2 + s^2*t^4 + s^2 + t^2, { <<1, 2, 2>, <2, 4, 4>>, <<2, 1, 3>, <2, 3,
    1>>, <<2, 1, 3>, <2, 4, 4>>, <<2, 3, 1>, <2, 4, 4>>, <<1, 2, 2>, <2, 1, 3>>,
    <<1, 2, 2>, <2, 3, 1>> }>,
    <s^4*t^4 + 2*s^4*t^2 + s^4 + 2*s^2*t^4 - 12*s^2*t^2 + 2*s^2 + t^4 + 2*t^2 + 
        1, { <<1, 1, 4>, <2, 3, 3>>, <<1, 2, 2>, <2, 3, 3>>, <<1, 4, 1>, <2, 3, 
    3>>, <<1, 1, 4>, <1, 4, 1>>, <<1, 2, 2>, <1, 4, 1>>, <<1, 1, 4>, <1, 2, 2>> 
    }>,
    <s^2*t^2 - s^2 - 4*s*t - t^2 + 1, { <<1, 3, 4>, <1, 6, 5>>, <<1, 6, 5>, <2, 
    1, 1>>, <<1, 4, 3>, <1, 5, 6>>, <<1, 5, 6>, <2, 1, 1>>, <<1, 4, 3>, <1, 6, 
    5>>, <<1, 3, 4>, <1, 5, 6>> }>,
    <s^4*t^4 + 4*zeta*s^4*t^3 - 6*s^4*t^2 - 4*zeta*s^4*t + s^4 + 2*s^2*t^4 - 
        24*zeta*s^2*t^3 - 12*s^2*t^2 + 24*zeta*s^2*t + 2*s^2 + t^4 + 4*zeta*t^3 
        - 6*t^2 - 4*zeta*t + 1, { <<1, 3, 6>, <1, 4, 5>>, <<1, 3, 6>, <2, 2, 
    2>>, <<1, 4, 5>, <2, 2, 2>> }>,
    <s^4*t^4 + 2*s^4*t^2 + s^4 - 4*zeta*s^3*t^4 + 24*zeta*s^3*t^2 - 4*zeta*s^3 -
        6*s^2*t^4 - 12*s^2*t^2 - 6*s^2 + 4*zeta*s*t^4 - 24*zeta*s*t^2 + 4*zeta*s
        + t^4 + 2*t^2 + 1, { <<1, 6, 4>, <2, 2, 2>>, <<1, 5, 3>, <2, 2, 2>>, 
    <<1, 5, 3>, <1, 6, 4>> }>,
    <s^4*t^4 - 2*s^4*t^2 + s^4 + 2*s^2*t^4 + 12*s^2*t^2 + 2*s^2 + t^4 - 2*t^2 + 
        1, { <<1, 3, 1>, <2, 4, 3>>, <<1, 2, 2>, <2, 1, 4>>, <<1, 3, 1>, <2, 1, 
    4>>, <<2, 1, 4>, <2, 4, 3>>, <<1, 2, 2>, <1, 3, 1>>, <<1, 2, 2>, <2, 4, 3>> 
    }>,
    <s^2*t^2 - s^2 + 4*s*t - t^2 + 1, { <<1, 4, 3>, <1, 6, 6>>, <<1, 6, 6>, <2, 
    1, 1>>, <<1, 4, 3>, <1, 5, 5>>, <<1, 3, 4>, <1, 5, 5>>, <<1, 3, 4>, <1, 6, 
    6>>, <<1, 5, 5>, <2, 1, 1>> }>,
    <s^4*t^2 + 2*zeta*s^3*t^4 + 2*zeta*s^3 - 6*s^2*t^2 - 2*zeta*s*t^4 - 2*zeta*s
        + t^2, { <<2, 2, 2>, <2, 5, 3>>, <<1, 6, 1>, <2, 2, 2>>, <<1, 6, 1>, <2,
    5, 3>> }>,
    <s^2*t^2 - 2*zeta*s^2*t - s^2 - 2*zeta*s*t^2 + 4*s*t + 2*zeta*s - t^2 + 
        2*zeta*t + 1, { <<1, 4, 6>, <1, 5, 3>>, <<1, 3, 5>, <1, 6, 4>>, <<1, 3, 
    5>, <1, 5, 3>>, <<1, 4, 6>, <1, 6, 4>> }>,
    <s^4*t^4 - 4*zeta*s^4*t^3 - 6*s^4*t^2 + 4*zeta*s^4*t + s^4 + 4*zeta*s^3*t^4 
        - 48*s^3*t^3 - 24*zeta*s^3*t^2 + 48*s^3*t + 4*zeta*s^3 - 6*s^2*t^4 + 
        24*zeta*s^2*t^3 + 36*s^2*t^2 - 24*zeta*s^2*t - 6*s^2 - 4*zeta*s*t^4 + 
        48*s*t^3 + 24*zeta*s*t^2 - 48*s*t - 4*zeta*s + t^4 - 4*zeta*t^3 - 6*t^2 
        + 4*zeta*t + 1, { <<2, 6, 5>, <4, 2, 2>> }>,
    <s^4*t^4 - 2*s^4*t^2 + s^4 + 4*zeta*s^3*t^4 + 24*zeta*s^3*t^2 + 4*zeta*s^3 -
        6*s^2*t^4 + 12*s^2*t^2 - 6*s^2 - 4*zeta*s*t^4 - 24*zeta*s*t^2 - 4*zeta*s
        + t^4 - 2*t^2 + 1, { <<2, 2, 2>, <2, 6, 1>>, <<2, 2, 2>, <2, 5, 4>>, 
    <<2, 5, 4>, <2, 6, 1>> }>,
    <s^4*t^4 - 2*s^4*t^2 + s^4 - 2*s^2*t^4 - 12*s^2*t^2 - 2*s^2 + t^4 - 2*t^2 + 
        1, { <<1, 3, 4>, <1, 4, 3>>, <<1, 2, 2>, <1, 4, 3>>, <<1, 2, 2>, <2, 1, 
    1>>, <<1, 4, 3>, <2, 1, 1>>, <<1, 2, 2>, <1, 3, 4>>, <<1, 3, 4>, <2, 1, 1>> 
    }>,
    <s^4*t^3 - s^4*t + 1/2*zeta*s^2*t^4 - 3*zeta*s^2*t^2 + 1/2*zeta*s^2 + t^3 - 
        t, { <<2, 2, 2>, <2, 3, 6>>, <<1, 1, 5>, <2, 2, 2>>, <<1, 1, 5>, <2, 3, 
    6>> }>,
    <s^4*t^4 + 2*s^4*t^2 + s^4 - 2*s^2*t^4 + 12*s^2*t^2 - 2*s^2 + t^4 + 2*t^2 + 
        1, { <<1, 1, 3>, <2, 3, 4>>, <<1, 1, 3>, <1, 2, 2>>, <<1, 1, 3>, <2, 4, 
    1>>, <<2, 3, 4>, <2, 4, 1>>, <<1, 2, 2>, <2, 3, 4>>, <<1, 2, 2>, <2, 4, 1>> 
    }>
];



 
